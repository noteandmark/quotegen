<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Quotegen App</title>
    <!-- Bootstrap core CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
            crossorigin="anonymous"></script>
</head>
<body>
<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
    <div class="container">
        <a class="navbar-brand" href="#">linkedin.com/in/noteandmark/</a>
    </div>
</nav>
<div class="container mt-5">
    <div class="row">
        <div class="col-sm-8">
            <section class="header">
                <h3 class="display-4">Quotegen Application</h3>

                <!-- Buttons for ALL users -->
                <div class="btn-group mt-3" role="group">
                    <button type="button" class="btn btn-info" onclick="window.location.href='public/help'">Помощь[TODO]
                    </button>
                    <button type="button" class="btn btn-primary" onclick="window.location.href='public/stats'">
                        Статистика
                    </button>
                    <button type="button" class="btn btn-primary" onclick="window.location.href='public/da-net'">Да/Нет
                    </button>
                    <button type="button" class="btn btn-primary" onclick="window.location.href='public/version'">
                        Версия
                    </button>
                    <button type="button" class="btn btn-primary" onclick="window.location.href='public/report'">
                        Репорт[TODO]
                    </button>
                </div>

                    <!-- Buttons for role USER -->
                <div class="btn-group mt-3" role="group">
                    <div sec:authorize="hasRole('ROLE_USER')">
                        <button type="button" class="btn btn-primary"
                                onclick="window.location.href='/web/divination'">Гадание
                        </button>
                        <button type="button" class="btn btn-primary"
                                onclick="window.location.href='/web/getquote'">Случайная цитата
                        </button>
                        <button type="button" class="btn btn-primary"
                                onclick="window.location.href='/web/quotes-for-week'">Цитаты за неделю
                        </button>
                    </div>
                </div>

                    <!-- Buttons for role ADMIN -->
                <div class="btn-group mt-3" role="group">
                    <div sec:authorize="hasRole('ROLE_ADMIN')">
                        <button type="button" class="btn btn-primary"
                                onclick="window.location.href='/web/divination'">Гадание
                        </button>
                        <button type="button" class="btn btn-primary"
                                onclick="window.location.href='/web/getquote'">Случайная цитата
                        </button>
                        <button type="button" class="btn btn-primary"
                                onclick="window.location.href='/web/quotes-for-week'">Цитаты за неделю
                        </button>
                        <button type="button" class="btn btn-primary"
                                onclick="window.location.href='/admin/requestquote'">Запрос цитаты
                        </button>
                    </div>
                </div>

            </section>

            <br>
            <!--        work with xmlns:sec= etc.-->
            <div sec:authorize="isAuthenticated()">
                <h5 class="card-title" th:text="'Добро пожаловать, ' + ${#authentication.name}"></h5>
                <div class="p-3 border bg-light">Вам доступны новые возможности в системе</div>
            </div>
            <div sec:authorize="hasRole('ROLE_USER')">
                <span>Приятного пользования, дорогой друг</span>
                <br>
            </div>
            <div sec:authorize="hasRole('ROLE_ADMIN')">
                <span>Для админа открыты все двери</span>
                <br>
            </div>
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Книголюб</h5>
                    <p class="card-text">
                        Автоматизированная система по генерации цитат из книг:
                        <br>
                    <ul>
                        <li>QuoteGen - приложение, которое генерирует случайные цитаты из случайно выбранной книги в
                            электронной библиотеке пользователя. Приложение сканирует предложенный каталог и все
                            подпапки, находит книги в форматах EPUB, FB2, DOC, DOCX, PDF и сохраняет информацию о них в
                            базу данных.
                        </li>
                        <li>QuoteBot - телеграм-бот, предоставляет доступ ко всем точкам REST API приложения.</li>
                        <li>QuotegenWeb - веб-приложение для доступа ко всем возможностям программы через браузер.</li>
                    </ul>
                    Использованные технологии и библиотеки:
                    <br>
                    Java20, Spring Boot 3.1.2, Maven, Spring Security 6, Spring Data JPA, Spring Validation, PostgreSQL,
                    H2 database, SLF4J logging, Telegram API, Google Custom Search API, Thymeleaf, Bootstrap5, Lombok,
                    ModelMapper, org.jsoup, org.apache.pdfbox, com.kursx.parser.fb2, org.apache.poi, nl.siegmann.epublib
                    <br><br>
                    Пользователю доступны возможности:
                    <ul>
                        <li>получить статистику</li>
                        <li>получить ответ в виде gif изображения "да" или "нет"</li>
                        <li>погадать на книге: назвать страницу и строку, и приложение, случайно выбрав книгу, вернет
                            указанное место
                        </li>
                        <li>получить случайную цитату из опубликованных ранее</li>
                        <li>получить все цитаты за текущую неделю</li>
                        <li>прочитать о версии и списке изменений</li>
                        <li>отправить сообщение админу: баг, отзыв, предложения</li>
                    </ul>
                    <br>
                    Админ может:
                    <ul>
                        <li>сканировать директорию на наличие электронных книг и сохранять их в БД</li>
                        <li>делать запрос о генерации случайной цитаты</li>
                        <li>получать по расписанию случайную цитату</li>
                    </ul>
                    </p>
                </div>
            </div>

        </div>

        <!--        // Authorisation and registration-->
        <div class="col-sm-4 mt-5">
            <div class="card">
                <div class="card-body">

                    <!-- Condition for displaying the login and registration -->
                    <div th:if="${#authentication.name == 'anonymousUser'}">
                        <h5 class="card-title">Вход для расширенных возможностей</h5>
                        <p th:text="${#authentication.name}" style="display:none;"></p>
                        <form th:action="@{/auth/process_login}" method="post">
                            <!-- Fields for entering login and password -->
                            <div class="mb-3">
                                <label for="username" class="form-label">Имя пользователя</label>
                                <input type="text" class="form-control" id="username" name="username" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Пароль</label>
                                <input type="password" class="form-control" id="password" name="password" required>
                            </div>
                            <button type="submit" class="btn btn-success">Войти</button>
                            <a th:href="@{/auth/registration}" class="btn btn-success">Зарегистрироваться</a>
                            <div th:if="${errorMessage}" class="alert alert-danger">
                                <p th:text="${errorMessage}"></p>
                            </div>
                        </form>
                    </div>

                    <!-- Condition of profile display and exit button -->
                    <div th:if="${#authentication.name != 'anonymousUser'}">
                        <h5 class="card-title">Профиль пользователя</h5>
                        Authenticated as <span sec:authentication="name"></span>
                        <a th:href="@{'/web/profile/' + ${#authentication.principal.username}}" class="btn btn-primary">Профиль</a>
                        <br>
                        <form th:action="@{/signout}" method="post">
                            <span>Выйти</span>
                            <button type="submit" class="btn btn-danger">Signout</button>
                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>

</div>
</body>
</html>